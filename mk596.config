// Versions of individual modules
params.illumVersion     = '1.0.1'
params.ashlarVersion    = '1.13.0'
params.coreoVersion     = '2.2.2'
params.unmicstVersion   = '2.6.10'
params.cypositoryVersion= '1.0.11'
params.mcilastikVersion = '1.4.2'
params.s3segVersion     = '1.2.5'
params.quantVersion     = '1.3.2'
params.nstatesVersion   = '1.6.2'

docker.enabled = false
singularity.enabled    = true
singularity.autoMounts = true
singularity.runOptions = '-C'

singularity.cacheDir = '/n/scratch3/users/m/mk596/nanosaber-mcmicro/singularity'

env.JAVA_TOOL_OPTIONS = "-Xmx60G"

process {
  executor = 'slurm'
  queue = 'short'
  withName:illumination {
    time = '6h'
    memory = '64G'
    // container = "docker://labsyspharm/basic-illumination:${params.illumVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-basic-illumination-${params.illumVersion}.sif"
  }
  withName:ashlar {
    time = '6h'
    memory = '64G'
    // container = "docker://labsyspharm/ashlar:${params.ashlarVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-ashlar-${params.ashlarVersion}.sif"
  }
  withName:coreograph {
    time = '1h'
    memory = '64G'
    // container = "docker://labsyspharm/unetcoreograph:${params.coreoVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-unetcoreograph-${params.coreoVersion}.sif"
  }
  withName:unmicst {
    time = '12h'
    memory = '128G'
    // container = "docker://labsyspharm/unmicst:${params.unmicstVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-unmicst-${params.unmicstVersion}.sif"
  }
  withName:cypository {
    // container = "docker://labsyspharm/cypository:${params.cypositoryVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-cypository-${params.cypositoryVersion}.sif"
  }
  withName:ilastik {
    cpus = 8
    time = '12h'
    memory = '128G'
    // container = "docker://labsyspharm/mcmicro-ilastik:${params.mcilastikVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-mcmicro-ilastik-${params.mcilastikVersion}.sif"
  }
  withName:s3seg {
    cpus = 6
    time = '6h'
    memory = '80G'
    // container = "docker://labsyspharm/s3segmenter:${params.s3segVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-s3segmenter-${params.s3segVersion}.sif"
  }
  withName:quantification {
    time = '12h'
    memory = '128G'
    // container = "docker://labsyspharm/quantification:${params.quantVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-quantification-${params.quantVersion}.sif"
  }
  withName:naivestates {
    time = '12h'
    memory = '128G'
    // container = "docker://labsyspharm/naivestates:${params.nstatesVersion}"
    container = "file:///n/app/singularity/containers/mk596/labsyspharm-naivestates-${params.nstatesVersion}.sif"
  }
}
